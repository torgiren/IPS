#!/usr/bin/env python
#-*- coding: utf-8 -*-
from scapy.all import *
import sys
if len(sys.argv)<4:
	print "Usage: %s <host> <start_port> <end_port>"
	exit(1)
a=IP(dst=sys.argv[1])
b=TCP(dport=(int(sys.argv[2]),int(sys.argv[3])),flags='A')
ans,unans=sr(a/b,retry=0,timeout=3)
num=0
for i in ans:
		if i[1][1].flags==4:
			num+=1
			print "port %s jest niefiltrowany"%(i[1][TCP].sport)
